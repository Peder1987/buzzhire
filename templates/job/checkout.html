{% extends 'job/jobrequest_detail.html' %}
{% load icons django_bootstrap_breadcrumbs crispy_forms_tags payment core_tags %}

{% block page_actions %}{% endblock %}

{% block inner_breadcrumb %}
  {{ block.super }}
  {% breadcrumb object object.get_absolute_url %}
{% endblock %}

{% block content %}
    <div class='row'>
        <div class='col-md-5'>
            {% summary object %}    
        </div>
        <div class='col-md-7'>
            {% crispy form %}    
        </div>
    </div>
{% endblock %}

{% block extrascripts %}
    {{ block.super }}
    <script src="https://js.braintreegateway.com/v2/braintree.js"></script>
    <script>
      {% comment %}
        This inserts the Braintree Drop-In UI into the form.
        The form then communicates with Braintree and provides a payment nonce,
        which is then posted via the form for Django to process as a payment.
      {% endcomment %}
      braintree.setup("{% payment_client_token client %}", 'dropin', {
          container: 'payment-method-container',
          onReady: function () {
            // Show the submit button once the form has loaded
            $('#pay-button').show();
          },
        });
    </script>
{% endblock %}

// disable submit button
$('#submit-button').prop("disabled", true);
braintree.setup('your-client-token', 'dropin', {
container: 'dropin',
paymentMethodNonceReceived: function (event, nonce) {
// do something
}, 
onReady: function () {
// enable your submit button
$('#submit-button').prop("disabled", false);
}
});